services:
  web-check:
    container_name: Web-Check-Checkit
    build:
      context: .
      dockerfile: Dockerfile.dev
    ports:
      - "3003:4321"  # Frontend (Astro dev)
      - "3004:3001"  # Backend (Express API)
    restart: unless-stopped
    environment:
      - NODE_ENV=development
      - PORT=3001
      # PUBLIC_API_ENDPOINT removed - use relative /api paths
    volumes:
      # Mount source code for live updates without rebuild
      - ./src:/app/src:ro
      - ./server:/app/server:ro
      - ./api:/app/api:ro
      - ./public:/app/public:ro
      # Persist SQLite database between container restarts
      - checkit-database:/app/database

volumes:
  checkit-database:
    driver: local
